<cu-custom bgColor="bg-gradual-blue" isBack="{{true}}">
  <view slot="back-text">返回</view>
  <view slot="content">配置管理</view>
</cu-custom>

<view class="cu-card article">
  <view class="cu-item shadow">
    <view class="title">
      <view class="text-cut">AppID配置状态</view>
    </view>
    <view class="content">
      <view class="desc">
        <view class="cu-list menu">
          <view class="cu-item" wx:for="{{configStatus}}" wx:key="*this" wx:for-item="platform" wx:for-key="key">
            <view class="content">
              <text class="cuIcon-{{platform.configured ? 'check' : 'close'}} text-{{platform.configured ? 'green' : 'red'}}"></text>
              <text class="text-grey">{{key}}</text>
            </view>
            <view class="action">
              <text class="text-{{platform.configured ? 'green' : 'red'}} text-sm">
                {{platform.configured ? '已配置' : '未配置'}}
              </text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<view class="cu-card article">
  <view class="cu-item shadow">
    <view class="title">
      <view class="text-cut">微信小程序AppID</view>
    </view>
    <view class="content">
      <view class="desc">
        <view class="cu-bar bg-gray light">
          <view class="action">
            <text class="cuIcon-peoplefill text-blue"></text>
            <text class="text-bold">当前AppID:</text>
          </view>
          <view class="action">
            <button class="cu-btn round line-blue sm" bindtap="copyAppId" data-appid="{{configStatus['mp-weixin'].appid}}">
              <text class="cuIcon-copy"></text>复制
            </button>
          </view>
        </view>
        <view class="padding-sm bg-blue light">
          <text class="text-bold text-blue">{{configStatus['mp-weixin'].appid || '未配置'}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

<view class="cu-bar bg-white solid-bottom margin-top">
  <view class="action">
    <text class="cuIcon-settings text-blue"></text>配置操作
  </view>
</view>

<view class="cu-list menu">
  <view class="cu-item" bindtap="showConfigForm">
    <view class="content">
      <text class="cuIcon-edit text-blue"></text>
      <text class="text-grey">修改AppID</text>
    </view>
    <view class="action">
      <text class="cuIcon-right text-gray"></text>
    </view>
  </view>
  
  <view class="cu-item" bindtap="showHelp">
    <view class="content">
      <text class="cuIcon-question text-orange"></text>
      <text class="text-grey">配置帮助</text>
    </view>
    <view class="action">
      <text class="cuIcon-right text-gray"></text>
    </view>
  </view>
  
  <view class="cu-item" bindtap="reloadProject">
    <view class="content">
      <text class="cuIcon-refresh text-green"></text>
      <text class="text-grey">重新加载项目</text>
    </view>
    <view class="action">
      <text class="cuIcon-right text-gray"></text>
    </view>
  </view>
</view>

<!-- AppID配置表单 -->
<view class="cu-modal {{showForm ? 'show' : ''}}" bindtap="hideConfigForm">
  <view class="cu-dialog" catchtap="">
    <view class="cu-bar bg-white justify-end">
      <view class="content">配置AppID</view>
      <view class="action" bindtap="hideConfigForm">
        <text class="cuIcon-close text-red"></text>
      </view>
    </view>
    <view class="padding-xl">
      <view class="cu-form-group">
        <view class="title">平台</view>
        <picker bindchange="PlatformChange" value="{{index}}" range="{{platforms}}">
          <view class="picker">
            {{platforms[index]}}
          </view>
        </picker>
      </view>
      <view class="cu-form-group">
        <view class="title">AppID</view>
        <input placeholder="请输入AppID" value="{{newAppId}}" bindinput="onAppIdInput"></input>
      </view>
      <view class="padding flex flex-direction">
        <button class="cu-btn bg-blue margin-tb-sm" bindtap="saveAppId">保存</button>
        <button class="cu-btn line-gray margin-tb-sm" bindtap="hideConfigForm">取消</button>
      </view>
    </view>
  </view>
</view>

<view class="cu-tabbar-height"></view>