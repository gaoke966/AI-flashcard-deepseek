<cu-custom>
  <view slot="content">Token调试</view>
</cu-custom>

<view class="cu-card case">
  <view class="cu-item shadow">
    <view class="cu-bar bg-white solid-bottom">
      <view class="action">
        <text class="cuIcon-title text-blue"></text>平台信息
      </view>
    </view>
    <view class="padding">
      <text class="text-sm">{{platformInfo}}</text>
    </view>
  </view>
</view>

<view class="cu-card case">
  <view class="cu-item shadow">
    <view class="cu-bar bg-white solid-bottom">
      <view class="action">
        <text class="cuIcon-title text-green"></text>Token状态
      </view>
    </view>
    <view class="padding">
      <view class="cu-item">
        <text class="text-grey">GlobalData Token:</text>
        <text class="text-cut">{{globalDataToken}}</text>
      </view>
      <view class="cu-item">
        <text class="text-grey">AuthManager Token:</text>
        <text class="text-cut">{{authManagerToken}}</text>
      </view>
      <view class="cu-item">
        <text class="text-grey">getUserToken结果:</text>
        <text class="text-cut">{{getUserTokenResult ? getUserTokenResult.substring(0, 50) + '...' : '未测试'}}</text>
      </view>
    </view>
  </view>
</view>

<view class="padding flex flex-direction">
  <button class="cu-btn bg-blue margin-tb-sm" bindtap="testAuthManager" loading="{{loading}}">
    测试AuthManager
  </button>
  <button class="cu-btn bg-green margin-tb-sm" bindtap="testGetUserToken">
    测试getUserToken
  </button>
  <button class="cu-btn bg-orange margin-tb-sm" bindtap="setTokenManually">
    手动设置Token
  </button>
  <button class="cu-btn bg-purple margin-tb-sm" bindtap="testApiCall">
    测试API调用
  </button>
  <button class="cu-btn bg-red margin-tb-sm" bindtap="clearToken">
    清除Token
  </button>
  <button class="cu-btn bg-grey margin-tb-sm" bindtap="clearLogs">
    清空日志
  </button>
</view>

<view class="cu-card case">
  <view class="cu-item shadow">
    <view class="cu-bar bg-white solid-bottom">
      <view class="action">
        <text class="cuIcon-title text-grey"></text>操作日志
      </view>
    </view>
    <view class="padding">
      <scroll-view scroll-y style="max-height: 300px;">
        <view class="text-xs" wx:for="{{logs}}" wx:key="index" style="margin-bottom: 4px;">
          {{item}}
        </view>
      </scroll-view>
    </view>
  </view>
</view>